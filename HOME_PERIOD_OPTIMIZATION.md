# Оптимізація періоду завантаження сесій для home.dart

## Проблема
На сторінці home.dart показувались записи лише за поточний місяць. Якщо зараз останні дні місяця, то не відображались записи з наступного місяця.

## Рішення
Розширили період завантаження до **поточний місяць + 2 наступних місяці** (всього 3 місяці).

## Реалізація

### 1. Новий метод в FirestoreService
```dart
Future<List<Session>> getSessionsForPeriod(DateTime startDate, DateTime endDate)
```
- Один запит замість трьох окремих
- Фільтрація на рівні БД
- Оптимізовано для періоду в 3 місяці

### 2. Оновлений AppStateProvider
```dart
final startDate = DateTime(now.year, now.month, 1);
final endDate = DateTime(now.year, now.month + 3, 1);
final sessions = await _firestoreService.getSessionsForPeriod(startDate, endDate);
```

## Вплив на Firebase ліміти

### До оптимізації:
- 1 запит `getSessionsByMonth()` на відкриття home.dart
- ~50-200 документів за запит
- Обмеження: `limit(200)`

### Після оптимізації:
- 1 запит `getSessionsForPeriod()` на відкриття home.dart  
- ~150-500 документів за запит (3 місяці)
- Обмеження: `limit(500)`

### Firebase Spark план (безкоштовний):
- **Ліміт**: 50,000 читань/день
- **Поточне використання**: ~100-300 читань/день (залежно від активності)
- **Після змін**: ~100-500 читань/день
- **Висновок**: Цілком безпечно для типового салону

### Оптимізації:
1. **Один запит замість трьох** - економія мережевого трафіку
2. **Кешування з TTL 4 хвилини** - мінімізація повторних запитів
3. **Source.server** - обхід локального кешу для синхронізації
4. **Фільтрація на рівні БД** - менше даних передається

## Переваги
✅ Показуються записи з наступних місяців  
✅ Один запит замість трьох  
✅ Безпечно для Firebase лімітів  
✅ Кращий UX наприкінці місяця  
✅ Зберігається продуктивність

## Моніторинг
В логах додано інформацію про:
- Період завантаження сесій
- Кількість сесій по місяцях  
- Загальну кількість завантажених записів
- Час виконання запитів

## Рекомендації для продакшену
1. Моніторинг Firebase використання в консолі
2. При необхідності можна зменшити до 2 місяців
3. Можливість додавання власного індексу для оптимізації запитів