# –ê–Ω–∞–ª—ñ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ Firestore –ë–î

## üìä –ü–û–¢–û–ß–ù–ê –°–ò–¢–£–ê–¶–Ü–Ø –ü–û –ó–ê–ü–ò–¢–ê–ú

### üî• –ö–†–ò–¢–ò–ß–ù–Ü –ú–ï–¢–û–î–ò (–∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å –í–°–Ü –¥–æ–∫—É–º–µ–Ω—Ç–∏)

#### 1. **getMasters()** - lib/services/firestore_service.dart:19
```dart
final QuerySnapshot snapshot = await _mastersCollection.get();
```
- **–ó–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –≤–∏–∫–ª–∏–∫**: 1 —á–∏—Ç–∞–Ω–Ω—è —Ö –∫—ñ–ª—å–∫—ñ—Å—Ç—å –º–∞–π—Å—Ç—Ä—ñ–≤
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**: –ü—Ä–∏ –∫–æ–∂–Ω–æ–º—É `refreshAllData()` (–∫–æ–∂–Ω—ñ 5 —Ö–≤ + –ø—Ä–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó)
- **–ß–∞—Å—Ç–æ—Ç–∞**: ~300 —Ä–∞–∑—ñ–≤/–¥–µ–Ω—å
- **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**: –ù–µ–æ–±–º–µ–∂–µ–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –º–∞–π—Å—Ç—Ä—ñ–≤

#### 2. **getClients()** - lib/services/firestore_service.dart:183  
```dart
final QuerySnapshot snapshot = await _clientsCollection.get();
```
- **–ó–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –≤–∏–∫–ª–∏–∫**: 1 —á–∏—Ç–∞–Ω–Ω—è —Ö –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–ª—ñ—î–Ω—Ç—ñ–≤  
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**: –ü—Ä–∏ –∫–æ–∂–Ω–æ–º—É `refreshAllData()` (–∫–µ–∂–Ω—ñ 5 —Ö–≤ + –ø—Ä–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó)
- **–ß–∞—Å—Ç–æ—Ç–∞**: ~300 —Ä–∞–∑—ñ–≤/–¥–µ–Ω—å
- **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**: –ù–µ–æ–±–º–µ–∂–µ–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–ª—ñ—î–Ω—Ç—ñ–≤

#### 3. **getSessionsByMonth()** - lib/services/firestore_service.dart:716
```dart
final QuerySnapshot snapshot = await _sessionsCollection.get(); // –í–°–Ü —Å–µ—Å—ñ—ó!
```
- **–ó–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –≤–∏–∫–ª–∏–∫**: 1 —á–∏—Ç–∞–Ω–Ω—è —Ö –í–°–Ü —Å–µ—Å—ñ—ó (–Ω–µ —Ç—ñ–ª—å–∫–∏ –∑–∞ –º—ñ—Å—è—Ü—å!)
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**: –ü—Ä–∏ –∫–æ–∂–Ω–æ–º—É `refreshAllData()` (–∫–æ–∂–Ω—ñ 5 —Ö–≤)
- **–ß–∞—Å—Ç–æ—Ç–∞**: ~300 —Ä–∞–∑—ñ–≤/–¥–µ–Ω—å  
- **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**: –í–°–Ü —Å–µ—Å—ñ—ó –∑–∞ –≤–µ—Å—å —á–∞—Å (—Ç–∏—Å—è—á—ñ!)

#### 4. **getAllSessions()** - lib/services/firestore_service.dart:639
```dart
final QuerySnapshot snapshot = await _sessionsCollection.get();
```
- **–ó–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –≤–∏–∫–ª–∏–∫**: 1 —á–∏—Ç–∞–Ω–Ω—è —Ö –í–°–Ü —Å–µ—Å—ñ—ó
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**: 
  - Archive page: `_forceReloadData()` - –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—ñ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É
  - ClientList page: –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
- **–ß–∞—Å—Ç–æ—Ç–∞**: ~50-100 —Ä–∞–∑—ñ–≤/–¥–µ–Ω—å
- **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**: –í–°–Ü —Å–µ—Å—ñ—ó –∑–∞ –≤–µ—Å—å —á–∞—Å

#### 5. **getAllClientsWithVipStatus()** - lib/services/firestore_service.dart:321
```dart
final QuerySnapshot sessionsSnapshot = await _sessionsCollection.get(); // –í–°–Ü —Å–µ—Å—ñ—ó!
final QuerySnapshot clientsSnapshot = await _clientsCollection.get();   // –í–°–Ü –∫–ª—ñ—î–Ω—Ç–∏!
```
- **–ó–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –≤–∏–∫–ª–∏–∫**: 2 —á–∏—Ç–∞–Ω–Ω—è (—Å–µ—Å—ñ—ó + –∫–ª—ñ—î–Ω—Ç–∏) —Ö —ó—Ö –∫—ñ–ª—å–∫—ñ—Å—Ç—å
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**: Clients page –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ/–æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ
- **–ß–∞—Å—Ç–æ—Ç–∞**: ~20-50 —Ä–∞–∑—ñ–≤/–¥–µ–Ω—å
- **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**: –í–°–Ü —Å–µ—Å—ñ—ó + –í–°–Ü –∫–ª—ñ—î–Ω—Ç–∏

#### 6. **getUniqueClientsWithVipStatus()** - lib/services/firestore_service.dart:200
```dart
final QuerySnapshot sessionsSnapshot = await _sessionsCollection.get(); // –í–°–Ü —Å–µ—Å—ñ—ó!
```
- **–ó–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –≤–∏–∫–ª–∏–∫**: 1 —á–∏—Ç–∞–Ω–Ω—è —Ö –í–°–Ü —Å–µ—Å—ñ—ó
- **–ß–∞—Å—Ç–æ—Ç–∞**: –†—ñ–¥–∫–æ, –∞–ª–µ —Ç–µ–∂ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –≤—Å–µ

## üìà –†–û–ó–†–ê–•–£–ù–û–ö –©–û–î–ï–ù–ù–û–ì–û –í–ò–ö–û–†–ò–°–¢–ê–ù–ù–Ø

### –ü—Ä–∏–ø—É—Å—Ç–∏–º–æ —É –≤–∞—Å:
- **–ú–∞–π—Å—Ç—Ä–∏**: 5 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
- **–ö–ª—ñ—î–Ω—Ç–∏**: 100 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤  
- **–°–µ—Å—ñ—ó**: 2000 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ (–Ω–∞–∫–æ–ø–∏—á–µ–Ω—ñ –∑–∞ —á–∞—Å)

### –©–æ–¥–µ–Ω–Ω—ñ –∑–∞–ø–∏—Ç–∏:

#### AppStateProvider (–∞–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 5 —Ö–≤):
- `getMasters()`: 288 –≤–∏–∫–ª–∏–∫—ñ–≤/–¥–µ–Ω—å √ó 5 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ = **1,440 —á–∏—Ç–∞–Ω—å**
- `getClients()`: 288 –≤–∏–∫–ª–∏–∫—ñ–≤/–¥–µ–Ω—å √ó 100 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ = **28,800 —á–∏—Ç–∞–Ω—å**  
- `getSessionsByMonth()`: 288 –≤–∏–∫–ª–∏–∫—ñ–≤/–¥–µ–Ω—å √ó 2000 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ = **576,000 —á–∏—Ç–∞–Ω—å** ‚ö†Ô∏è

#### Archive page (–ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—ñ):
- `getAllSessions()`: 20 –≤–∏–∫–ª–∏–∫—ñ–≤/–¥–µ–Ω—å √ó 2000 –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ = **40,000 —á–∏—Ç–∞–Ω—å**

#### Clients page:
- `getAllClientsWithVipStatus()`: 10 –≤–∏–∫–ª–∏–∫—ñ–≤/–¥–µ–Ω—å √ó (2000 + 100) –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ = **21,000 —á–∏—Ç–∞–Ω—å**

### **–ó–ê–ì–ê–õ–¨–ù–ò–ô –ü–Ü–î–°–£–ú–û–ö –ó–ê –î–ï–ù–¨**: ~667,240 —á–∏—Ç–∞–Ω—å! üö®

## üö® –ü–†–û–ë–õ–ï–ú–ò

1. **–ü–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—è –ª—ñ–º—ñ—Ç—É**: –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ 50,000 —á–∏—Ç–∞–Ω—å/–¥–µ–Ω—å, –∞ –ø–æ—Ç—Ä—ñ–±–Ω–æ 667,240!
2. **–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—è**: –£ 13+ —Ä–∞–∑—ñ–≤ –±—ñ–ª—å—à–µ –∑–∞ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –ª—ñ–º—ñ—Ç
3. **–í–∞—Ä—Ç—ñ—Å—Ç—å –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—è**: ~$36/–º—ñ—Å—è—Ü—å —Ç—ñ–ª—å–∫–∏ –∑–∞ —á–∏—Ç–∞–Ω–Ω—è –ë–î
4. **–ü–æ–≤—ñ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞**: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∏—Å—è—á –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω

## ‚úÖ –ü–û–¢–û–ß–ù–Ü –û–ü–¢–ò–ú–Ü–ó–ê–¶–Ü–á (–≤–∂–µ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω—ñ)

### –ö–µ—à—É–≤–∞–Ω–Ω—è –≤ AppStateProvider:
- **–ú–∞–π—Å—Ç—Ä–∏**: –∫–µ—à –Ω–∞ 15 —Ö–≤–∏–ª–∏–Ω (–µ–∫–æ–Ω–æ–º—ñ—è ~80%)
- **–ö–ª—ñ—î–Ω—Ç–∏**: –∫–µ—à –Ω–∞ 5 —Ö–≤–∏–ª–∏–Ω (–µ–∫–æ–Ω–æ–º—ñ—è ~70%)  
- **–°–µ—Å—ñ—ó**: –∫–µ—à –Ω–∞ 5 —Ö–≤–∏–ª–∏–Ω (–µ–∫–æ–Ω–æ–º—ñ—è ~70%)

### –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ø—ñ—Å–ª—è –∫–µ—à—É–≤–∞–Ω–Ω—è:
- `getMasters()`: 96 –≤–∏–∫–ª–∏–∫—ñ–≤/–¥–µ–Ω—å √ó 5 = **480 —á–∏—Ç–∞–Ω—å** (‚Üì97%)
- `getClients()`: 144 –≤–∏–∫–ª–∏–∫—ñ–≤/–¥–µ–Ω—å √ó 100 = **14,400 —á–∏—Ç–∞–Ω—å** (‚Üì50%)
- `getSessionsByMonth()`: 144 –≤–∏–∫–ª–∏–∫—ñ–≤/–¥–µ–Ω—å √ó 2000 = **288,000 —á–∏—Ç–∞–Ω—å** (‚Üì50%)

### **–©–æ–¥–µ–Ω–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑ –∫–µ—à—É–≤–∞–Ω–Ω—è–º**: ~362,880 —á–∏—Ç–∞–Ω—å
### **–ï–∫–æ–Ω–æ–º—ñ—è**: 304,360 —á–∏—Ç–∞–Ω—å/–¥–µ–Ω—å (45% –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è)

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–á –î–õ–Ø –î–û–î–ê–¢–ö–û–í–û–á –û–ü–¢–ò–ú–Ü–ó–ê–¶–Ü–á

### 1. –î–æ–¥–∞—Ç–∏ .limit() –¥–æ –∑–∞–ø–∏—Ç—ñ–≤:
```dart
// –ó–∞–º—ñ—Å—Ç—å
final QuerySnapshot snapshot = await _sessionsCollection.get();

// –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏
final QuerySnapshot snapshot = await _sessionsCollection
    .limit(50)  // –û–±–º–µ–∂–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å
    .get();
```

### 2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏ –ø–æ –¥–∞—Ç–∞—Ö:
```dart
// –î–ª—è getSessionsByMonth() - —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –≤ –ë–î, –Ω–µ –≤ –∫–æ–¥—ñ
final QuerySnapshot snapshot = await _sessionsCollection
    .where('date', isGreaterThanOrEqualTo: '2025-10-01')
    .where('date', isLessThan: '2025-11-01')
    .get();
```

### 3. –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö —Å–ø–∏—Å–∫—ñ–≤:
```dart
// –î–ª—è archive —Ç–∞ clients
final QuerySnapshot snapshot = await _sessionsCollection
    .orderBy('date', descending: true)
    .limit(20)
    .get();
```

### 4. –ó–º–µ–Ω—à–∏—Ç–∏ —á–∞—Å—Ç–æ—Ç—É –∞–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è:
```dart
// –ó–∞–º—ñ—Å—Ç—å –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω - –∫–æ–∂–Ω—ñ 15 —Ö–≤–∏–ª–∏–Ω
Timer.periodic(Duration(minutes: 15), ...);
```

## üí∞ –ï–ö–û–ù–û–ú–Ü–ß–ù–ò–ô –ï–§–ï–ö–¢ –ü–Ü–°–õ–Ø –í–°–Ü–• –û–ü–¢–ò–ú–Ü–ó–ê–¶–Ü–ô

### –Ø–∫—â–æ –¥–æ–¥–∞—Ç–∏ .limit(50) + —Ñ—ñ–ª—å—Ç—Ä–∏ –ø–æ –¥–∞—Ç–∞—Ö:
- **–î–æ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó**: 667,240 —á–∏—Ç–∞–Ω—å/–¥–µ–Ω—å
- **–ü—ñ—Å–ª—è –∫–µ—à—É–≤–∞–Ω–Ω—è**: 362,880 —á–∏—Ç–∞–Ω—å/–¥–µ–Ω—å  
- **–ü—ñ—Å–ª—è limit + —Ñ—ñ–ª—å—Ç—Ä—ñ–≤**: ~15,000 —á–∏—Ç–∞–Ω—å/–¥–µ–Ω—å
- **–ï–∫–æ–Ω–æ–º—ñ—è**: 97.8% –∑–∞–ø–∏—Ç—ñ–≤!

### –í–∞—Ä—Ç—ñ—Å—Ç—å:
- **–ó–∞—Ä–∞–∑**: $36/–º—ñ—Å—è—Ü—å
- **–ü—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó**: $0/–º—ñ—Å—è—Ü—å (–≤ –º–µ–∂–∞—Ö –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ–≥–æ –ª—ñ–º—ñ—Ç—É)

## üöÄ –í–ò–°–ù–û–í–û–ö

**–ü–æ—Ç–æ—á–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–µ—à—É–≤–∞–Ω–Ω—è –≤–∂–µ –¥–æ–±—Ä–µ –ø—Ä–∞—Ü—é—î**, –∞–ª–µ –¥–ª—è –ø–æ–≤–Ω–æ—ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –ø–æ—Ç—Ä—ñ–±–Ω–æ:

1. ‚úÖ **–ö–µ—à—É–≤–∞–Ω–Ω—è** (–≤–∂–µ –∑—Ä–æ–±–ª–µ–Ω–æ) - –µ–∫–æ–Ω–æ–º—ñ—è 45%
2. üîÑ **–î–æ–¥–∞—Ç–∏ .limit()** –¥–æ –≤—Å—ñ—Ö –∑–∞–ø–∏—Ç—ñ–≤ - –µ–∫–æ–Ω–æ–º—ñ—è —â–µ 70%  
3. üîÑ **–§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –ø–æ –¥–∞—Ç–∞—Ö –≤ –ë–î** - –µ–∫–æ–Ω–æ–º—ñ—è —â–µ 15%
4. üîÑ **–ó–º–µ–Ω—à–∏—Ç–∏ —á–∞—Å—Ç–æ—Ç—É –∞–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è** - –µ–∫–æ–Ω–æ–º—ñ—è —â–µ 5%

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ó 667,240 –¥–æ ~15,000 —á–∏—Ç–∞–Ω—å/–¥–µ–Ω—å (97.8% –µ–∫–æ–Ω–æ–º—ñ—è!)